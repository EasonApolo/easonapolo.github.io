(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["twit"],{"0a49":function(t,e,n){var i=n("9b43"),a=n("626a"),c=n("4bf8"),o=n("9def"),s=n("cd1c");t.exports=function(t,e){var n=1==t,r=2==t,d=3==t,u=4==t,l=6==t,h=5==t||l,m=e||s;return function(e,s,f){for(var p,v,g=c(e),_=a(g),w=i(s,f,3),y=o(_.length),C=0,x=n?m(e,y):r?m(e,0):void 0;y>C;C++)if((h||C in _)&&(p=_[C],v=w(p,C,g),t))if(n)x[C]=v;else if(v)switch(t){case 3:return!0;case 5:return p;case 6:return C;case 2:x.push(p)}else if(u)return!1;return l?-1:d||u?u:x}}},1169:function(t,e,n){var i=n("2d95");t.exports=Array.isArray||function(t){return"Array"==i(t)}},"378d":function(t,e,n){},"49be":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"twit"}},[n("layout",{scopedSlots:t._u([{key:"main",fn:function(){return[n("list",{attrs:{loading:t.intSwitch},scopedSlots:t._u([{key:"list",fn:function(){return t._l(t.data,function(e,i){return n("div",{key:i,staticClass:"item",class:t.template(e)},[n("div",{staticClass:"meta"},[n("div",{staticClass:"name"},[t._v(t._s(e.author_name))]),n("div",{staticClass:"date"},[t._v(t._s(t.slicedDate(e.date)))])]),n("div",{staticClass:"content",domProps:{innerHTML:t._s(e.content.rendered)},on:{click:function(e){return t.clickbub(e)}}}),n("div",{staticClass:"opmenu"},[n("div",{staticClass:"comments",on:{click:function(n){return t.setReplyTo(e)}}},[n("div",{staticClass:"icon",staticStyle:{width:"1.25rem"}},[n("svg",{attrs:{viewBox:"0 0 24 24"}},[n("path",{attrs:{fill:"#ccc",d:"M14.046 2.242l-4.148-.01h-.002c-4.374 0-7.8 3.427-7.8 7.802 0 4.098 3.186 7.206 7.465 7.37v3.828c0 .108.044.286.12.403.142.225.384.347.632.347.138 0 .277-.038.402-.118.264-.168 6.473-4.14 8.088-5.506 1.902-1.61 3.04-3.97 3.043-6.312v-.017c-.006-4.367-3.43-7.787-7.8-7.788zm3.787 12.972c-1.134.96-4.862 3.405-6.772 4.643V16.67c0-.414-.335-.75-.75-.75h-.396c-3.66 0-6.318-2.476-6.318-5.886 0-3.534 2.768-6.302 6.3-6.302l4.147.01h.002c3.532 0 6.3 2.766 6.302 6.296-.003 1.91-.942 3.844-2.514 5.176z"}})])]),n("div",{staticClass:"num"},[t._v(t._s(0===e.child.length?"":e.child.length))])]),n("div",{staticClass:"addreact"},[t._v("＋\n                "),n("div",{staticClass:"list"},t._l(t.map,function(i,a){return n("div",{key:i,staticClass:"addreact-item",on:{click:function(n){return t.react(e,a)}}},[t._v(t._s(i))])}),0)]),n("div",{staticClass:"react"},t._l(t.itemReact(e),function(e,i){return n("div",{key:i,staticClass:"added"},[t._v("\n                  "+t._s(t.map[i])+t._s(e)+"\n                ")])}),0)]),t._l(e.child,function(e,i){return n("div",{key:i,staticClass:"item item-child"},[n("div",{staticClass:"meta"},[n("div",{staticClass:"name"},[t._v(t._s(e.author_name||"~"))]),n("div",{staticClass:"date"},[t._v(t._s(t.slicedDate(e.date)))])]),n("div",{staticClass:"content",domProps:{innerHTML:t._s(e.content.rendered)},on:{click:function(e){return t.clickbub(e)}}})])})],2)})},proxy:!0}])})]},proxy:!0},{key:"right",fn:function(){return[n("rbox",{attrs:{title:"回复"},scopedSlots:t._u([{key:"list",fn:function(){return[n("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"item",attrs:{type:"text",placeholder:"标题/姓名（或空格）"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}}),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"item",attrs:{type:"text",placeholder:"内容",rows:"10"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:0!=t.toParent,expression:"toParent != 0"}],staticClass:"item replyto",on:{click:function(e){t.toParent=0}}},[t._v("回复给"),n("i",[t._v(t._s(t.toParentName))]),n("br"),t._v("（点击取消）")]),n("div",{staticClass:"item plain"},[n("button",{on:{click:t.send}})]),n("rbox",{attrs:{title:"preset titles:"},scopedSlots:t._u([{key:"list",fn:function(){return t._l(t.templates,function(e,i){return n("div",{key:i,staticClass:"item",on:{click:function(n){t.name=e}}},[t._v(t._s(e))])})},proxy:!0}])})]},proxy:!0}])})]},proxy:!0}])})],1)},a=[],c=n("f499"),o=n.n(c),s=(n("28a5"),n("a481"),n("7514"),n("7f7f"),n("cadf"),n("551c"),n("f751"),n("097d"),n("ebad")),r=n("7117"),d=n("2e90"),u=(n("3a5e"),{name:"twit",data:function(){return{intSwitch:0,mainNode:void 0,listNode:void 0,data:[],max_page:101,name:localStorage.name||"",content:localStorage.content||"",addOpen:!1,large_device:!0,reactdata:[],toParent:0,map:{gd:"🉑",zn:"👍",sh:"💩",nm:"🍋",ca:"👎",wh:"❓",ha:"🐸",gt:"❗",hp:"😨",dg:"🐶",tt:"🍭",qq:"😘"},templates:["~","#Changing","#日常","#今日不平常","#？","#朝花夕拾","#feel low"]}},components:{layout:s["a"],rbox:r["a"],list:d["a"]},created:function(){var t=this;this.fetchComment(1),this.setDevice(),window.addEventListener("resize",function(){t.setDevice()}),setInterval(this.autoSave,5e3)},mounted:function(){this.mainNode=document.getElementsByClassName("main")[0],this.mainNode.addEventListener("scroll",this.scrollBottom),this.listNode=document.getElementsByClassName("list")[0]},computed:{template:function(){return function(t){switch(t.author_name){case"#Changing":return{changing:!0};case"#日常":return{nichijou:!0};case"#今日不平常":return{special:!0};case"#？":return{what:!0};case"#朝花夕拾":return{recorder:!0};case"#feel low":return{feellow:!0}}}},toParentName:function(){var t=this,e=this.data.find(function(e){return e.id===t.toParent});return void 0===e?"":e.author_name},itemReact:function(){var t=this;return function(e){var n=t.reactdata.find(function(t){return t.id==e.id});return void 0===n?[]:n.react}},slicedContent:function(){return function(t){var e=t.replace(/<[^>]*>/g,"");return e}},slicedDate:function(){return function(t){var e=t.split(/[-T:]/);return e[0]=e[0].slice(2,4),e=e.slice(0,-1),e=e.slice(0,3).join("-")+" "+e.slice(3,5).join(":"),e}}},methods:{autoSave:function(){this.name.length>0&&(localStorage.autosavename=this.name),this.content.length>0&&(localStorage.autosavecontent=this.content)},fetchReact:function(){var t=this;fetch(window.domain+"/react/react.php").then(function(t){return t.json()}).then(function(e){t.reactdata=e})},react:function(t,e){var n,i=this;n=""===t.meta.react?{}:t.meta.react,n[e]=e in n?n[e]+1:1,t.meta.react=n;o()(n);var a=new FormData;a.append("id",t.id),a.append("rid",e),fetch(window.domain+"/react/react.php",{method:"POST",body:a}).then(function(t){return t.json()}).then(function(t){i.reactdata=t})},scrollBottom:function(){if("/twit"==this.$route.path&&0==this.intSwitch&&this.mainNode.scrollTop+this.mainNode.clientHeight>=this.listNode.clientHeight+48){var t=Math.ceil(this.data.length/10+1);this.fetchComment(t)}},clickbub:function(t){"IMG"===t.target.nodeName&&("100%"===t.target.style.maxWidth?t.target.style.maxWidth="30%":t.target.style.maxWidth="100%")},setReplyTo:function(t){this.toParent=t.id,this.large_device||(this.addOpen=!0)},setDevice:function(){this.large_device=document.documentElement.clientWidth>750},clearComment:function(){this.data=[],this.max_page=1e3},fetchComment:function(t){var e=this;t>this.max_page||(this.intSwitch=1,fetch(window.ip+"comments?post=53&page="+t+"&parent=0").then(function(t){return t.json()}).then(function(n){0==n.length&&(e.max_page=t-1),n.map(function(t){t.child=[]}),e.data=e.data.concat(n),e.intSwitch=0;var i=n.map(function(t){return t.id});e.fetchChildComments(i),e.fetchReact()}))},fetchChildComments:function(t){var e=this;fetch(window.ip+"comments?post=53&parent="+t.join(",")).then(function(t){return t.json()}).then(function(t){t.map(function(t){for(var n in e.data)e.data[n].id===t.parent&&(void 0===e.data[n].child?e.data[n].child=[t]:e.data[n].child.push(t))})})},send:function(){var t=this;if(""!=this.content&&""!=this.name){this.$bus.$emit("pop","发送中..."),this.intSwitch=1;var e=new FormData;e.append("author_name",this.name),e.append("content",this.content),e.append("parent",this.toParent),e.append("post",53),e.append("author_email","787817128@qq.com"),fetch(window.ip+"comments",{method:"POST",body:e}).then(function(){t.toParent=0,t.addOpen=!1,t.clearComment(),t.$bus.$emit("pop","已发送"),t.intSwitch=1,t.fetchComment(1)})}else this.$bus.$emit("pop","至少填个空格嗷")}}}),l=u,h=(n("bf18"),n("2877")),m=Object(h["a"])(l,i,a,!1,null,"755bc46d",null);e["default"]=m.exports},7514:function(t,e,n){"use strict";var i=n("5ca1"),a=n("0a49")(5),c="find",o=!0;c in[]&&Array(1)[c](function(){o=!1}),i(i.P+i.F*o,"Array",{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(c)},a21f:function(t,e,n){var i=n("584a"),a=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return a.stringify.apply(a,arguments)}},bf18:function(t,e,n){"use strict";var i=n("378d"),a=n.n(i);a.a},cd1c:function(t,e,n){var i=n("e853");t.exports=function(t,e){return new(i(t))(e)}},e853:function(t,e,n){var i=n("d3f4"),a=n("1169"),c=n("2b4c")("species");t.exports=function(t){var e;return a(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!a(e.prototype)||(e=void 0),i(e)&&(e=e[c],null===e&&(e=void 0))),void 0===e?Array:e}},f499:function(t,e,n){t.exports=n("a21f")}}]);
//# sourceMappingURL=twit.a501dfbc.js.map