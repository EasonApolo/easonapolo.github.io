(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["art"],{"207e":function(t,e,n){"use strict";var a=n("ec94"),i=n.n(a);i.a},"3c17":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("layout",{scopedSlots:t._u([{key:"main",fn:function(){return[t.artData.title?n("div",{staticClass:"article",on:{click:function(e){t.rightToggle=!1}}},[n("div",{staticClass:"title"},[t._v(t._s(t.artData.title.rendered))]),n("div",{staticClass:"time"},[t._v(t._s(t.slicedDate(t.artData.date)))]),n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.artData.content.rendered)}})]):t._e(),n("Loading",{attrs:{intSwitch:t.switch1}}),n("div",{attrs:{id:"comment-header"}},[t._v("> 评论 { "+t._s(t.commentsData.length)+" }")]),t.commentsLoadOK?n("div",{staticClass:"comment-wrapper"},t._l(t.commentsData,function(e,a){return n("div",{key:e.id,staticClass:"comment"},[n("span",{staticClass:"name"},[t._v(t._s(e.author_name))]),0!==e.parent?n("span",{staticClass:"replyto"},[t._v("  --\x3e  "+t._s(t.replyToName(e.toIndex)))]):t._e(),n("span",{staticClass:"content"},[t._v(": "+t._s(e.content.rendered.replace(/<[^>]*>/g,"")))]),n("span",{staticClass:"reply",on:{click:function(e){t.commentToIndex=a}}},[t._v("回复")]),n("span",{staticClass:"time"},[t._v(t._s(t.slicedDate(e.date)))])])}),0):t._e(),n("Loading",{attrs:{intSwitch:t.switch2}}),n("ul",{staticClass:"add",on:{click:function(e){t.rightToggle=!1}}},[n("li",[t._v("> 添加评论"),n("span",{directives:[{name:"show",rawName:"v-show",value:-1!==t.commentToIndex,expression:"commentToIndex !== -1"}],staticClass:"addTo"},[t._v("\n            对  "),n("i",[t._v(" "+t._s(t.commentToName)+" ")]),n("span",{attrs:{id:"removeAddTo"},on:{click:function(e){t.commentToIndex=-1}}},[t._v("取消")])])]),n("li",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.addContent,expression:"addContent"}],attrs:{name:"content",rows:"2",placeholder:"评论"},domProps:{value:t.addContent},on:{input:function(e){e.target.composing||(t.addContent=e.target.value)}}})]),n("li",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.addName,expression:"addName"}],attrs:{name:"name",placeholder:"名字"},domProps:{value:t.addName},on:{input:function(e){e.target.composing||(t.addName=e.target.value)}}})]),n("li",[n("input",{class:{disabled:t.addSending},attrs:{type:"submit",value:"提交"},on:{click:t.addComment}})])])]},proxy:!0},{key:"right",fn:function(){return[t.titles.length>0?n("rbox",{class:{mini:!t.miniRight},attrs:{title:"目录"},on:{click:function(e){t.rightToggle=!t.rightToggle}},scopedSlots:t._u([{key:"list",fn:function(){return t._l(t.titles,function(e,a){return n("div",{key:a,staticClass:"item",class:{second:void 0!=e[1]},on:{click:function(e){return t.jumpToTitle(e,a)}}},[void 0==e[1]?n("span",[t._v(t._s(e[0]))]):t._e(),t._v("\n            "+t._s(e[2])+"\n          ")])})},proxy:!0}],null,!1,3800357185)}):t._e()]},proxy:!0}])})],1)},i=[],o=(n("a481"),n("28a5"),n("cadf"),n("551c"),n("f751"),n("097d"),n("ebad")),s=n("7117"),c=n("3a5e"),d={name:"art",data:function(){return{postId:0,artData:{},titles:[],commentsData:{},commentsLoadOK:!1,navData:[],switch1:0,switch2:0,commentToIndex:-1,addName:"",addContent:"",addSending:!1,rightToggle:!1,mainNode:void 0}},components:{Loading:c["a"],layout:o["a"],rbox:s["a"]},computed:{replyToName:function(){var t=this;return function(e){return t.commentsData[e].author_name}},commentToName:function(){var t=this.commentsData[this.commentToIndex];return t?t.author_name:""},slicedDate:function(){return function(t){var e=t.split(/[-T:]/);return e[0]=e[0].slice(2,4),e=e.slice(0,-1),e=e.slice(0,3).join("-")+" "+e.slice(3,5).join(":"),e}},miniRight:function(){return document.body.clientWidth>750||this.rightToggle}},created:function(){this.postId=this.$route.query.id,this.fetchArticle(),this.fetchComment()},mounted:function(){this.mainNode=document.getElementsByClassName("main")[0]},methods:{addComment:function(){var t=this;if(!this.addSending){if(""!==this.addContent.replace(/\s+/g,"")){this.addSending=!0;var e=new FormData,n=-1==this.commentToIndex?0:this.commentsData[this.commentToIndex].id;return e.append("author_name",this.addName),e.append("content",this.addContent),e.append("parent",n),e.append("post",this.postId),e.append("author_email","787817128@qq.com"),fetch(window.ip+"comments",{method:"POST",body:e}).then(function(){t.addSending=!1,t.addName=t.addContent="",t.commentToIndex=-1,t.fetchComment()}),0}this.$bus.$emit("pop","姓名或评论不能为空*A*")}},fetchArticle:function(){var t=this;this.switch1=1,fetch(window.ip+"posts/"+this.postId).then(function(t){return t.json()}).then(function(e){t.artData=e,t.switch1=0,setTimeout(t.getTitles,0)})},getTitles:function(){var t,e=/>([IVX]+\.)([IVX]+)*(.+?(?=<))/g,n=[];while(null!=(t=e.exec(this.artData.content.rendered)))n.push([t[1],t[2],t[3]]);this.titles=n},jumpToTitle:function(t,e){t.stopPropagation();for(var n=this.titles[e].join(""),a=document.getElementsByTagName("p"),i=0;i<a.length;i++)if(a[i].innerText==n){this.mainNode.scrollTop=a[i].offsetTop;break}},fetchComment:function(){var t=this;this.switch2=1,fetch(window.ip+"comments?order=asc&post="+this.postId).then(function(t){return t.json()}).then(function(e){t.commentsData=e;for(var n=t.commentsData.length,a=0;a<n;a++){var i=t.commentsData[a].parent;if(0!==i)for(var o=0;o<a;o++)if(t.commentsData[o].id===i){t.commentsData[a].toIndex=o;break}}t.switch2=0,t.commentsLoadOK=!0})},reload:function(t){var e=this.navData[t].id;-1!==e?(this.$router.push({path:"art",query:{id:e}}),this.postId=this.$route.query.id,this.artData={},this.commentsData={},this.commentsLoadOK=!1,this.navData=[],this.commentToIndex=-1,this.addName="",this.addContent="",this.fetchArticle(),this.fetchComment()):this.$bus.$emit("pop",this.navData[t].title)}}},r=d,m=(n("207e"),n("2877")),l=Object(m["a"])(r,a,i,!1,null,"60c243dd",null);e["default"]=l.exports},ec94:function(t,e,n){}}]);
//# sourceMappingURL=art.14eaba99.js.map